\section{Problem Formulations}
\label{sec:problem}

\subsection{Single MapReduce Query}

\subsubsection*{Minimize WAN usage}

When minimizing WAN usage for a MapReduce data shuffle we have the following optimization problem:
\begin{subequations}
	\begin{align}
		\min_{r} \quad & \sum_{j}D_j(1-r_j) \\
		\text{s.t.} \quad & \sum_{j}r_{j} = 1 \\
		& r_{j} \geq 0 \quad \forall j
	\end{align}
\end{subequations}

\subsubsection*{Feasibility to meet deadline}

We want to find a feasible $r$ so that the data shuffle finishes at or before $t$:
\begin{subequations}
	\begin{align}
		\text{find } r \text{ s.t.} \quad & \dfrac{D_{i}r_{j}}{B_{ij}} \leq t - s \quad \forall (i,j):j\neq i \\
		& \sum_{j}r_{j} = 1 \\
		& r_{j} \geq 0 \quad \forall j
	\end{align}
\end{subequations}

\subsubsection*{Minimize WAN usage given a shuffle deadline}
When minimizing WAN usage for a MapReduce data shuffle for a given deadline $t$ we have the following optimization problem:
\begin{subequations}\label{eq:opt_1Q_MR_WAN_deadline}
	\begin{align}
		\min_{r} \quad & \sum_{j}D_j(1-r_j) \\
		\text{ s.t.} \quad & \dfrac{D_{i}r_{j}}{B_{ij}} \leq t - s \quad \forall (i,j):i\neq j \\
		& \sum_{j}r_{j} = 1 \\
		& r_{j} \geq 0 \quad \forall j
	\end{align}
\end{subequations}

\subsection{Single DAG Query}
\subsubsection*{Minimize WAN usage}

When minimizing WAN usage for a DAG we have the following optimization problem:
\begin{subequations}
	\begin{align}
		\min_{r,D} \quad & \sum_{k\in\mathcal{N}}\sum_{j\in\mathcal{L}}D_j^k(1-r_j^k) \\
		\text{s.t.} \quad & \sum_{j}r_j^k = 1 \quad \forall k\in\mathcal{N}\\
		& r_j^k \geq 0 \quad \forall j\in\mathcal{L},\forall k\in\mathcal{N} \\
		& D_j^l = \sum_{k:(k,l)\in\mathcal{D}}\alpha^kr_j^k\sum_{i\in\mathcal{L}}D_i^k \quad \forall l\in\mathcal{N}
	\end{align}
\end{subequations}
Even without adding deadlines, this problem has nonlinear terms in the objective function and the last equality constraint.